<!DOCTYPE html>
<html lang="en">
  <head>
    <title>USERGUIDE  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="USERGUIDE  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          MiniApp 5.5.0 Docs
        </a>
         (67% documented)
      </p>
    
      <div class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </div>
    
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">MiniApp Reference</a>
      <img class="carat" src="img/carat.png" alt=""/>
      USERGUIDE  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="changelog.html">CHANGELOG</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="dev.html">DEV</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="readme.html">README</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="userguide.html">USERGUIDE</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/AdMobDisplayer.html">AdMobDisplayer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/HostAppThemeColors.html">HostAppThemeColors</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MAAnalyticsInfo.html">MAAnalyticsInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MAHostEnvironmentInfo.html">MAHostEnvironmentInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MAPoints.html">MAPoints</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MASDKCustomPermissionModel.html">MASDKCustomPermissionModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MATokenInfo.html">MATokenInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MessageToContact.html">MessageToContact</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniApp.html">MiniApp</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppActivityController.html">MiniAppActivityController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppAdDisplayer.html">MiniAppAdDisplayer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppAnalytics.html">MiniAppAnalytics</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppAnalyticsLoader.html">MiniAppAnalyticsLoader</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppCustomNavigationController.html">MiniAppCustomNavigationController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppExternalUrlLoader.html">MiniAppExternalUrlLoader</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppExternalWebViewController.html">MiniAppExternalWebViewController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppNavigationConfig.html">MiniAppNavigationConfig</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppSUIViewHandler.html">MiniAppSUIViewHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppSdkConfig.html">MiniAppSdkConfig</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppSharePreviewViewController.html">MiniAppSharePreviewViewController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppUI.html">MiniAppUI</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppView.html">MiniAppView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppView/MiniAppLoadStatus.html">– MiniAppLoadStatus</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MiniAppViewController.html">MiniAppViewController</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MAAnalyticsActionType.html">MAAnalyticsActionType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MAAnalyticsError.html">MAAnalyticsError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MAAnalyticsEventType.html">MAAnalyticsEventType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MASDKAccessTokenError.html">MASDKAccessTokenError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MASDKAdsDisplayError.html">MASDKAdsDisplayError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MASDKCustomPermissionError.html">MASDKCustomPermissionError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MASDKDownloadFileError.html">MASDKDownloadFileError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MASDKError.html">MASDKError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MASDKPermissionError.html">MASDKPermissionError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MASDKPermissionResponse.html">MASDKPermissionResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MASDKPointError.html">MASDKPointError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MASDKProtocolResponse.html">MASDKProtocolResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppCustomPermissionGrantedStatus.html">MiniAppCustomPermissionGrantedStatus</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppCustomPermissionType.html">MiniAppCustomPermissionType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppDevicePermissionType.html">MiniAppDevicePermissionType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppEvent.html">MiniAppEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppEvent/Event.html">– Event</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppJavaScriptError.html">MiniAppJavaScriptError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppKeyboardEvent.html">MiniAppKeyboardEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppKeyboardEvent/Event.html">– Event</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppNavigationAction.html">MiniAppNavigationAction</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppNavigationVisibility.html">MiniAppNavigationVisibility</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppSUIViewAction.html">MiniAppSUIViewAction</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppType.html">MiniAppType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppViewParameters.html">MiniAppViewParameters</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppViewParameters/DefaultParams.html">– DefaultParams</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppViewParameters/UrlParams.html">– UrlParams</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppViewParameters/InfoParams.html">– InfoParams</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MiniAppViewState.html">MiniAppViewState</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/UniversalBridgeError.html">UniversalBridgeError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Bundle.html">Bundle</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/NotificationCenter.html">NotificationCenter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/UIWindow.html">UIWindow</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ChatMessageBridgeDelegate.html">ChatMessageBridgeDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MAAnalyticsDelegate.html">MAAnalyticsDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppAdDisplayDelegate.html">MiniAppAdDisplayDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppDisplayDelegate.html">MiniAppDisplayDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppFallbackViewable.html">MiniAppFallbackViewable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppNavigationBarDelegate.html">MiniAppNavigationBarDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppNavigationDelegate.html">MiniAppNavigationDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppProgressViewable.html">MiniAppProgressViewable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppShareContentDelegate.html">MiniAppShareContentDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppUIDelegate.html">MiniAppUIDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppUserInfoDelegate.html">MiniAppUserInfoDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MiniAppViewable.html">MiniAppViewable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/UniversalBridgeDelegate.html">UniversalBridgeDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CloseAlertInfo.html">CloseAlertInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Host.html">Host</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MAAnalyticsConfig.html">MAAnalyticsConfig</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MAContact.html">MAContact</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MASDKAccessTokenScopes.html">MASDKAccessTokenScopes</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MASDKLocale.html">MASDKLocale</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MASDKLocale/LocalizableKey.html">– LocalizableKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MiniAppConfig.html">MiniAppConfig</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MiniAppConfigSSLKeyHash.html">MiniAppConfigSSLKeyHash</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MiniAppInfo.html">MiniAppInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MiniAppManifest.html">MiniAppManifest</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MiniAppReward.html">MiniAppReward</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MiniAppSDKConstants.html">MiniAppSDKConstants</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs.html#/s:7MiniApp0aB9SSLConfigV">MiniAppSSLConfig</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MiniAppSUIView.html">MiniAppSUIView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MiniAppSUIView.html#/s:7SwiftUI19UIViewRepresentableP11CoordinatorQa">– Coordinator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MiniAppShareContent.html">MiniAppShareContent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MiniAppUIParams.html">MiniAppUIParams</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PreviewMiniAppInfo.html">PreviewMiniAppInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/UniversalBridgeInfoParameters.html">UniversalBridgeInfoParameters</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Version.html">Version</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:7MiniApp15DownloadHeadersa">DownloadHeaders</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:7MiniApp34MASDKDownloadedListPermissionsPaira">MASDKDownloadedListPermissionsPair</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:7MiniApp0aB25NavigationResponseHandlera">MiniAppNavigationResponseHandler</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            
            <h1 id='miniapp' class='heading'>MiniApp</h1>

<p>This open-source library allows you to integrate Mini App ecosystem into your iOS applications.
Mini App SDK also facilitates communication between a Mini App and the host app via a message bridge.</p>
<h2 id='features' class='heading'>Features</h2>

<ul>
<li>Load MiniApp list</li>
<li>Load MiniApp metadata</li>
<li>Create a MiniAppView</li>
<li>Facilitate communication between host app and Mini App</li>
</ul>

<p>And much more features which you can find them in <a href="#usage">Usage</a>.</p>

<p>All the MiniApp files downloaded by the MiniApp iOS library are cached locally</p>
<h2 id='requirements' class='heading'>Requirements</h2>

<p>This module supports <strong>iOS 14.0 and above</strong>. It has been tested on iOS 14.0 and above.</p>

<p>It is written in Swift 5.0 and can be used in compatible Xcode versions.</p>

<p><em>Note:</em> This module is currently set to <code>deployment_target = &#39;14.0&#39;</code></p>
<h2 id='getting-started' class='heading'>Getting started</h2>

<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="https://rakutentech.github.io/ios-miniapp/">Documentation</a></li>
</ul>
<h3 id='installation' class='heading'>Installation</h3>

<p><a id="Cocoapods"></a></p>
<h2 id='cocoapods' class='heading'>Cocoapods</h2>

<p>Mini App SDK is available through <a href="https://cocoapods.org">CocoaPods</a>. To install it, simply add the following line to your Podfile:</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'MiniApp'</span>
</code></pre>

<p>The SDK can provide you some useful UI elements to help you displaying Mini Apps in your host app thanks to this subspec:</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'MiniApp/UI'</span>
</code></pre>

<p>If you need to support display of Google ads (up to version 8) triggered from your Mini App, you need to add the following subspec instead:</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'MiniApp/Admob'</span>
</code></pre>

<p>or if you need version 8 or above</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'MiniApp/Admob8'</span>
</code></pre>

<p>If you want to check the Mini App zip file integrity to prevent file corruption during download, adding <code>MiniApp/Signature</code> subspec will automatically enable it. </p>

<p>By default if the verification fails, it will trigger an <a href="#analytics-events">analytic event</a> but won&rsquo;t prevent the Mini App to load. <a href="#runtime-conf">There is a runtime configuration</a> to avoid a corrupted Mini App to be opened.
You can also provide a new default behavior by using a <code>RMARequireMiniAppSignatureVerification</code> boolean parameter in the application plist file (see the configuration matrix below to know more about the <code>RMARequireMiniAppSignatureVerification</code> parameter)</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'MiniApp/Signature'</span>
</code></pre>

<p><a id="Carthage"></a></p>
<h2 id='carthage' class='heading'>Carthage</h2>

<p>Due to some dependencies limitations, the Carthage version of MiniApp SDK embbed all the features <a href="#Cocoapods">described above</a>. It also needs the host projet to implement the latest Google Mobile Ads framework independently (see <a href="https://developers.google.com/admob/ios/quick-start">documentation</a>).
To depend on MiniApp SDK through Carthage add this line to you Cartfile:</p>
<pre class="highlight ruby"><code><span class="n">github</span> <span class="s2">"https://github.com/rakutentech/ios-miniapp"</span> <span class="s2">"prod"</span>
</code></pre>

<p><a id="SPM"></a></p>
<h2 id='swift-package-manager' class='heading'>Swift Package Manager</h2>

<p>To integrate MiniApp SDK into your Xcode project using Swift Package Manager, add it to the dependencies value of your <code>Package.swift</code>:</p>
<pre class="highlight ruby"><code><span class="ss">dependencies: </span><span class="p">[</span>
    <span class="p">.</span><span class="nf">package</span><span class="p">(</span><span class="ss">url: </span><span class="s2">"https://github.com/rakutentech/ios-miniapp.git"</span><span class="p">,</span> <span class="p">.</span><span class="nf">upToNextMajor</span><span class="p">(</span><span class="ss">from: </span><span class="s2">"5.5.0"</span><span class="p">))</span>
<span class="p">]</span>
</code></pre>
<h3 id='configuration' class='heading'>Configuration</h3>

<p>In your project configuration .plist you should add below Key/Value :</p>

<table><thead>
<tr>
<th style="text-align: left">Key</th>
<th style="text-align: center">Type</th>
<th style="text-align: left">Description</th>
<th style="text-align: center">Optional</th>
<th style="text-align: center">Default</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left">RASProjectId</td>
<td style="text-align: center">String</td>
<td style="text-align: left"><code>Set your MiniApp host application project identifier</code></td>
<td style="text-align: center">NO</td>
<td style="text-align: center"><code>none</code></td>
</tr>
<tr>
<td style="text-align: left">RASProjectSubscriptionKey</td>
<td style="text-align: center">String</td>
<td style="text-align: left"><code>Set your MiniApp subscription key</code></td>
<td style="text-align: center">NO</td>
<td style="text-align: center"><code>none</code></td>
</tr>
<tr>
<td style="text-align: left">RMAAPIEndpoint</td>
<td style="text-align: center">String</td>
<td style="text-align: left"><code>Provide your own Base URL for API requests</code></td>
<td style="text-align: center">NO</td>
<td style="text-align: center"><code>none</code></td>
</tr>
<tr>
<td style="text-align: left">RMASSLKeyHash</td>
<td style="text-align: center">Dictionary</td>
<td style="text-align: left"><code>This is the certificate keys hashes used for SSL pinning. The dictionary contains 2 keys: [main] with the main pin, and [backup] for the backup pin</code> .</td>
<td style="text-align: center">NO</td>
<td style="text-align: center"><code>none</code></td>
</tr>
<tr>
<td style="text-align: left">RMAHostAppUserAgentInfo</td>
<td style="text-align: center">String</td>
<td style="text-align: left"><code>Host app name and version info that is appended in User agent. The value specified in the plist is retrieved only at the build time.</code></td>
<td style="text-align: center">YES</td>
<td style="text-align: center"><code>none</code></td>
</tr>
<tr>
<td style="text-align: left">RMARequireMiniAppSignatureVerification</td>
<td style="text-align: center">Bool</td>
<td style="text-align: left"><code>This setting allows you to make the Mini App zip file signature validation mandatory. It is set to false by default, which means if a signature is not valid the mini app will still be launched</code></td>
<td style="text-align: center">YES</td>
<td style="text-align: center"><code>false</code></td>
</tr>
</tbody></table>

<p><a id="setting-admob"></a>Additionally, if you support Google ads with <code>MiniApp/Admob</code> subspec, you need to configure Google ads framework as advised into this <a href="https://developers.google.com/admob/ios/quick-start">documentation</a></p>

<p>If you don&rsquo;t want to use project settings, you have to pass this information one by one to the <code>Config.userDefaults</code> using a <code>Config.Key</code> as key:</p>
<pre class="highlight swift"><code><span class="kt">Config</span><span class="o">.</span><span class="n">userDefaults</span><span class="p">?</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="s">"MY_CUSTOM_ID"</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="kt">Key</span><span class="o">.</span><span class="n">subscriptionKey</span><span class="o">.</span><span class="n">rawValue</span><span class="p">)</span>
</code></pre>

<p><a id="usage"></a></p>
<h3 id='usage' class='heading'>Usage</h3>

<ul>
<li><a href="#configure-mini-app">Configure MiniApp</a></li>
<li><a href="#create-mini-app">Create a MiniApp</a></li>
<li><a href="#load-a-mini-app-from-bundle">Loading a Miniapp from Bundle</a></li>
<li><a href="#download-a-miniapp-in-background">Download a Miniapp in Background</a></li>
<li><a href="#mini-app-features">Mini App Features</a>

<ul>
<li><a href="#retrieve-unique-id">Retrieving Unique ID</a></li>
<li><a href="#request-location-permission">Requesting Location Permissions</a></li>
<li><a href="#custom-permissions">Custom Permissions</a></li>
<li><a href="#share-mini-app-content">Share Mini app content</a></li>
<li><a href="#ads-integration">Ads integration</a></li>
<li><a href="#retrieve-user-profile-details">Retrieve User Profile details</a></li>
<li><a href="#send-message-to-contacts">Send message to contacts</a></li>
<li><a href="#retrieve-points">Retrieve points</a></li>
<li><a href="#file-download">File Download</a></li>
<li><a href="#secure-storage">Secure Storage</a></li>
</ul></li>
<li><a href="#load-miniapp-list">Load the Mini App list</a></li>
<li><a href="#get-mini-appinfo">Get a MiniAppInfo</a></li>
<li><a href="#mini-meta-data">Mini App meta-data</a>

<ul>
<li><a href="#get-mini-meta-data">Getting a MiniApp meta-data</a></li>
<li><a href="#how-to-use-meta-data">How to use MiniApp meta-data</a></li>
<li><a href="#how-to-get-downloaded-meta-data">How to get downloaded MiniApp meta-data</a></li>
</ul></li>
<li><a href="#list-downloaded-mini-apps">List Downloaded Mini apps</a></li>
<li><a href="#advanced-features">Advanced Features</a>

<ul>
<li><a href="#runtime-conf">Overriding configuration on runtime</a></li>
<li><a href="#localization">Overriding localizations</a></li>
<li><a href="#custom-navigation">Customize history navigation</a></li>
<li><a href="#Opening-external-links">Opening external links</a></li>
<li><a href="#orientation-lock">Orientation Lock</a></li>
<li><a href="#analytics-events">Catching analytics events</a></li>
<li><a href="#query-param-mini-app">Passing Query parameters while creating Mini App</a></li>
<li><a href="#permissions-from-host-app">Permissions required from the Host app</a></li>
<li><a href="#miniapp-events">MiniApp events</a></li>
<li><a href="#miniapp-load-cache">Load Mini app from Cache</a></li>
<li><a href="#keyboard-events">Keyboard Events</a></li>
<li><a href="#miniapp-cache-available">MiniApp Cache available</a></li>
</ul></li>
</ul>

<p><a id="configure-mini-app"></a></p>
<h3 id='configure-miniapp' class='heading'>Configure MiniApp</h3>

<hr>

<ol>
<li>Import the MiniApp SDK in your <code>UIApplicationDelegate</code>:</li>
</ol>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">MiniApp</span>
</code></pre>

<ol>
<li><code><a href="Classes/MiniApp.html#/s:7MiniAppAAC9configureyyFZ">MiniApp.configure()</a></code> should be always called at launch by <code>AppDelegate</code>.</li>
</ol>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplication</span><span class="o">.</span><span class="kt">LaunchOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>

    <span class="kt">MiniApp</span><span class="o">.</span><span class="nf">configure</span><span class="p">()</span>
    <span class="c1">// ...</span>

    <span class="k">return</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre>

<p><a id="create-mini-app"></a></p>
<h3 id='create-a-miniapp-for-the-given-code-miniappid-code' class='heading'>Create a MiniApp for the given <code>MiniAppId</code> :</h3>

<hr>

<p><strong>API Docs:</strong>
<code>NOTE:  The method `create(appInfo: ,queryParams: ,completionHandler: ,messageInterface: ,adsDisplayer: ,fromCache: ) in `MiniApp` class will be deprecated in the upcoming release of MiniAppSDK, `load(fromCache: , completion: )` from `MiniAppView` must be used as shown below.</code></p>

<p><code><a href="Classes/MiniAppView.html">MiniAppView</a></code> is used to create a <code>View</code> for displaying a specific Mini App. You must provide the Mini App ID which you wish to create (you can get the Mini App ID by <a href="#load-miniapp-list">Loading the Mini App List</a> first). Calling <code><a href="Classes/MiniAppView.html">MiniAppView</a></code>&lsquo;s <code>load</code> method will do the following:</p>

<ul>
<li>Checks with the platform what is the latest and published version of the Mini App.</li>
<li>Check if the latest version of the Mini App has been already downloaded 

<ul>
<li>If yes, return the already downloaded Mini App view.</li>
<li>If not, download the latest version and then display the view</li>
</ul></li>
<li>If the device is disconnected from the internet and if the device already has a version of the Mini App downloaded, then the already downloaded version will be returned immediately.</li>
</ul>

<p>The following is a simplified example:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">MiniAppParameters</span><span class="o">.</span><span class="nf">default</span><span class="p">(</span>
    <span class="nv">config</span><span class="p">:</span> <span class="kt">MiniAppConfig</span><span class="p">(</span><span class="nv">config</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">current</span><span class="p">(),</span> <span class="nv">messageInterface</span><span class="p">:</span> <span class="k">self</span><span class="p">),</span>
    <span class="nv">appId</span><span class="p">:</span> <span class="s">"your-miniapp-id"</span>
<span class="p">)</span>
<span class="k">let</span> <span class="nv">miniAppView</span> <span class="o">=</span> <span class="kt">MiniAppView</span><span class="p">(</span><span class="nv">params</span><span class="p">:</span> <span class="n">params</span><span class="p">)</span>
<span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">miniAppView</span><span class="p">)</span>
<span class="n">miniAppView</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span>

<span class="c1">// load the miniapp</span>
<span class="n">miniAppView</span><span class="o">.</span><span class="n">load</span> <span class="p">{</span> <span class="n">success</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">success</span> <span class="p">{</span>
    <span class="c1">// miniAppView is loaded</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="s">"error: miniapp failed to load"</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="load-a-mini-app-from-bundle"></a></p>
<h3 id='load-a-miniapp-for-bundle' class='heading'>Load a MiniApp for Bundle</h3>

<hr>

<p>Miniapps can be loaded from Bundle now,</p>

<p>The following is a simplified example:</p>

<ol>
<li>Provide  the filname of the bundle, followed by MiniApp ID and VersionID
<code>swift
MiniApp.unzipMiniApp(fileName: &quot;js-miniapp-sample&quot;, miniAppId: &quot;mini-app-testing-appid&quot;, versionId: &quot;mini-app-testing-versionid&quot;)
</code></li>
<li>Your Miniapp will be extracted to the default location where all Miniapps are downloaded</li>
<li>Load Miniapp from Bundle</li>
</ol>
<pre class="highlight swift"><code>
<span class="c1">// notice the new parameter for ads delegation</span>
<span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">MiniAppParameters</span><span class="o">.</span><span class="nf">default</span><span class="p">(</span>
    <span class="nv">config</span><span class="p">:</span> <span class="kt">MiniAppConfig</span><span class="p">(</span><span class="nv">config</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">current</span><span class="p">(),</span> <span class="nv">adsDisplayer</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span> <span class="nv">messageInterface</span><span class="p">:</span> <span class="k">self</span><span class="p">),</span>
    <span class="nv">appId</span><span class="p">:</span> <span class="s">"mini-app-testing-appid"</span><span class="p">,</span>
    <span class="nv">version</span><span class="p">:</span> <span class="s">"mini-app-testing-versionid"</span>
<span class="p">)</span>
<span class="k">let</span> <span class="nv">miniAppView</span> <span class="o">=</span> <span class="kt">MiniAppView</span><span class="p">(</span><span class="nv">params</span><span class="p">:</span> <span class="n">params</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">loadFromBundle</span> <span class="p">{</span>
    <span class="c1">// Returns a MiniAppWebView to load</span>
<span class="p">}</span>
</code></pre>

<p><a id="download-a-miniapp-in-background"></a></p>
<h3 id='download-a-miniapp-in-background' class='heading'>Download a Miniapp in Background</h3>

<hr>

<p>Miniapps can be downloaded in background using the following method,</p>
<pre class="highlight swift"><code>
<span class="c1">// Please pass the valid Miniapp ID and version ID that is uploaded and available in platform to start downloading. </span>
<span class="c1">// Once the downloading is completed, completionHandler will let you know if the downloading is success or a failure</span>
<span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">current</span><span class="p">())</span><span class="o">.</span><span class="nf">downloadMiniApp</span><span class="p">(</span><span class="nv">appId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">versionId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">Bool</span><span class="p">,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>

<span class="p">}</span>
</code></pre>

<p><a id="mini-app-features"></a></p>
<h3 id='mini-app-features' class='heading'>Mini App Features</h3>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></p>

<p>The <code><a href="Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></code> is used for passing messages between the Mini App (JavaScript) and the Host App (your native iOS App) and vice versa. Your App must provide the implementation for these functions.</p>

<p>Mini App SDK provides default implementation for few interfaces in <code><a href="Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></code>, however the Host app can still override them by implementing the interface in their side.</p>

<table><thead>
<tr>
<th style="text-align: left">Method</th>
<th style="text-align: center">Default</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left">getUniqueId</td>
<td style="text-align: center">🚫</td>
</tr>
<tr>
<td style="text-align: left">getMessagingUniqueId</td>
<td style="text-align: center">🚫</td>
</tr>
<tr>
<td style="text-align: left">getMauid</td>
<td style="text-align: center">🚫</td>
</tr>
<tr>
<td style="text-align: left">requestDevicePermission</td>
<td style="text-align: center">🚫</td>
</tr>
<tr>
<td style="text-align: left">requestCustomPermissions</td>
<td style="text-align: center">✅</td>
</tr>
<tr>
<td style="text-align: left">shareContent</td>
<td style="text-align: center">✅</td>
</tr>
<tr>
<td style="text-align: left">getUserName</td>
<td style="text-align: center">🚫</td>
</tr>
<tr>
<td style="text-align: left">getProfilePhoto</td>
<td style="text-align: center">🚫</td>
</tr>
<tr>
<td style="text-align: left">getAccessToken</td>
<td style="text-align: center">🚫</td>
</tr>
<tr>
<td style="text-align: left">sendJsonToHostApp</td>
<td style="text-align: center">🚫</td>
</tr>
<tr>
<td style="text-align: left">getHostAppThemeColors</td>
<td style="text-align: center">🚫</td>
</tr>
<tr>
<td style="text-align: left">didReceiveMAAnalytics</td>
<td style="text-align: center">🚫</td>
</tr>
</tbody></table>

<p><code>NOTE: Following code snippets is an example for implementing MiniAppMessageDelegate methods, you can add your own custom implementation or you can make use of the code which is provided in the Sample app.</code></p>

<p><a id="retrieve-unique-id"></a></p>
<h5 id='retrieving-unique-id' class='heading'>Retrieving Unique ID</h5>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppUserInfoDelegate.html">MiniAppUserInfoDelegate</a></p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getUniqueId</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Implementation to return the Unique ID</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="s">""</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><code>NOTE:  This method `getUniqueId(completionHandler:)` will be deprecated in the upcoming release of MiniAppSDK. You should use `getMessagingUniqueId(completionHandler:)` instead.</code></p>

<p><a id="retrieve-unique-id"></a></p>
<h5 id='retrieving-messaging-unique-id' class='heading'>Retrieving Messaging Unique ID</h5>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppUserInfoDelegate.html">MiniAppUserInfoDelegate</a></p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getMessagingUniqueId</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Implementation to return the Messaging Unique ID</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="s">""</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="retrieve-unique-id"></a></p>
<h5 id='retrieving-unique-mauid-for-v2' class='heading'>Retrieving Unique MAUID for v2</h5>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppUserInfoDelegate.html">MiniAppUserInfoDelegate</a></p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getMauid</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Implementation to return the Unique MAUID</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="s">""</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="request-location-permission"></a></p>
<h5 id='requesting-location-permissions' class='heading'>Requesting Location Permissions</h5>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">requestDevicePermission</span><span class="p">(</span><span class="nv">permissionType</span><span class="p">:</span> <span class="kt">MiniAppDevicePermissionType</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">permissionType</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">location</span><span class="p">:</span>
            <span class="k">let</span> <span class="nv">locStatus</span> <span class="o">=</span> <span class="kt">CLLocationManager</span><span class="o">.</span><span class="nf">authorizationStatus</span><span class="p">()</span>
            <span class="k">switch</span> <span class="n">locStatus</span> <span class="p">{</span>
            <span class="k">case</span> <span class="o">.</span><span class="n">authorizedAlways</span><span class="p">,</span> <span class="o">.</span><span class="nv">authorizedWhenInUse</span><span class="p">:</span>
                <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="s">"allowed"</span><span class="p">))</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre>

<p><a id="custom-permissions"></a></p>
<h5 id='custom-permissions' class='heading'>Custom Permissions</h5>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></p>

<p>SDK has its own implementation to show the list of requested custom permissions. If you want to display your own UI for requesting custom permissions, you can do it by overriding the method like below,</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
        <span class="kd">func</span> <span class="nf">requestCustomPermissions</span><span class="p">(</span>
            <span class="nv">permissions</span><span class="p">:</span> <span class="p">[</span><span class="kt">MASDKCustomPermissionModel</span><span class="p">],</span>
            <span class="nv">miniAppTitle</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
            <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span>
            <span class="kt">Result</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">MASDKCustomPermissionModel</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
                <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">permissions</span><span class="p">))</span>    
            <span class="p">}</span>

</code></pre>
<h5 id='retrieving-and-storing-custom-permissions' class='heading'>Retrieving and storing Custom Permissions</h5>

<p>MiniApp iOS SDK supports list of Custom Permissions ( <code><a href="Enums/MiniAppCustomPermissionType.html">MiniAppCustomPermissionType</a></code>) and these can be stored and retrieved using the following public interfaces.</p>
<h5 id='retrieving-the-mini-app-custom-permissions-using-miniappid' class='heading'>Retrieving the Mini App Custom Permissions using MiniAppID</h5>

<p>Custom permissions and its status can be retrieved using the following interface. <code>getCustomPermissions</code> will return list  of <code><a href="Classes/MASDKCustomPermissionModel.html">MASDKCustomPermissionModel</a></code> that contains the meta-info such as title and its granted status.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">miniAppPermissionsList</span> <span class="o">=</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">getCustomPermissions</span><span class="p">(</span><span class="nv">forMiniApp</span><span class="p">:</span> <span class="n">miniAppId</span><span class="p">)</span>
</code></pre>

<p><a id="store-custom-permission"></a></p>
<h5 id='store-the-mini-app-custom-permissions' class='heading'>Store the Mini App Custom Permissions</h5>

<p>Custom permissions for a Mini App is cached by the SDK and you can use the following interface to store and retrieve it when you need.</p>
<pre class="highlight swift"><code> <span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">setCustomPermissions</span><span class="p">(</span><span class="nv">forMiniApp</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">permissionList</span><span class="p">:</span> <span class="p">[</span><span class="kt">MASDKCustomPermissionModel</span><span class="p">])</span>
</code></pre>

<p><a id="share-mini-app-content"></a></p>
<h5 id='share-mini-app-content' class='heading'>Share Mini app content</h5>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppShareContentDelegate.html">MiniAppShareContentDelegate</a></p>

<p>By default, Mini App iOS SDK can open its own controller for content sharing. If you want to override this, you just have to implement the <code>shareContent(info: MiniAppShareContent, completionHandler: @escaping (Result&lt;MASDKProtocolResponse, Error&gt;) -&gt; Void)</code> from <code><a href="Protocols/MiniAppShareContentDelegate.html">MiniAppShareContentDelegate</a></code>, which is part of <code><a href="Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></code>.</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">shareContent</span><span class="p">(</span><span class="nv">info</span><span class="p">:</span> <span class="kt">MiniAppShareContent</span><span class="p">,</span>
            <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span>
                <span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">activityController</span> <span class="o">=</span> <span class="kt">UIActivityViewController</span><span class="p">(</span><span class="nv">activityItems</span><span class="p">:</span> <span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">messageContent</span><span class="p">],</span> <span class="nv">applicationActivities</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
        <span class="nf">present</span><span class="p">(</span><span class="n">activityController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="s">"SUCCESS"</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="ads-integration"></a></p>
<h5 id='ads-integration' class='heading'>Ads integration</h5>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppAdDisplayDelegate.html">MiniAppAdDisplayDelegate</a></p>

<p>Mini App SDK gives you the possibility to display ads triggered by your Mini App from your host app.
There are 2 ways to achieve this: </p>

<ul>
<li>by implementing <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppAdDisplayDelegate.html">MiniAppAdDisplayDelegate</a> by yourself</li>
<li>if you rely on Google ads to display your ads you can simply implement <code>pod MiniApp/Admob</code> (Admob 7.+) or <code>pod MiniApp/Admob8</code> (Admob 8.+) into your pod dependencies (see <a href="#setting-admob">settings section</a>).
###### Google ads displayer</li>
</ul>

<p>When you chose to implement Google Ads support for your Mini Apps (see <a href="#setting-admob">configuration section</a>), you must provide an <a href="https://rakutentech.github.io/ios-miniapp/Classes/AdMobDisplayer.html"><code><a href="Classes/AdMobDisplayer.html">AdMobDisplayer</a></code></a> as adsDelegate parameter when creating your Mini App display:</p>

<p>Be careful when declaring your variable, as Mini App SDK does not keep a strong reference to it, it is preferable to declare it as a global variable or in most cases it will become nil once your method called.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">adsDisplayer</span> <span class="o">=</span> <span class="kt">AdMobDisplayer</span><span class="p">()</span> <span class="c1">// This is just declared here as a convenience for the example.</span>

<span class="c1">// notice the new parameter for ads delegation</span>
<span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">MiniAppParameters</span><span class="o">.</span><span class="nf">default</span><span class="p">(</span>
    <span class="nv">config</span><span class="p">:</span> <span class="kt">MiniAppConfig</span><span class="p">(</span><span class="nv">config</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">current</span><span class="p">(),</span> <span class="nv">adsDisplayer</span><span class="p">:</span> <span class="n">adsDisplayer</span><span class="p">,</span> <span class="nv">messageInterface</span><span class="p">:</span> <span class="k">self</span><span class="p">),</span>
    <span class="nv">appId</span><span class="p">:</span> <span class="s">"your-miniapp-id"</span>
<span class="p">)</span>
<span class="k">let</span> <span class="nv">miniAppView</span> <span class="o">=</span> <span class="kt">MiniAppView</span><span class="p">(</span><span class="nv">params</span><span class="p">:</span> <span class="n">params</span><span class="p">)</span>
</code></pre>
<h6 id='custom-ads-displayer' class='heading'>Custom ads displayer</h6>

<p>If you chose to implement ads displaying by yourself, you first need do implement <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppAdDisplayDelegate.html"><code><a href="Protocols/MiniAppAdDisplayDelegate.html">MiniAppAdDisplayDelegate</a></code></a> and provide it to a <a href="https://rakutentech.github.io/ios-miniapp/Classes/MiniAppAdDisplayer.html"><code><a href="Classes/MiniAppAdDisplayer.html">MiniAppAdDisplayer</a></code></a>.</p>

<p>For the same reasons mentioned in <code><a href="Classes/AdMobDisplayer.html">AdMobDisplayer</a></code> section above, prefer declaring your <code><a href="Classes/MiniAppAdDisplayer.html">MiniAppAdDisplayer</a></code> globally.</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">adsDisplayer</span><span class="p">:</span> <span class="kt">MiniAppAdDisplayer</span> 

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
      <span class="n">adsDisplayer</span> <span class="o">=</span> <span class="kt">MiniAppAdDisplayer</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span> <span class="c1">// you must provide your ads displayer a MiniAppAdDisplayDelegate</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppAdDisplayDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">loadInterstitial</span><span class="p">(</span><span class="k">for</span> <span class="nv">adId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">onLoaded</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">Void</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Here your code to load and prepare an interstitial ad</span>
        <span class="k">let</span> <span class="nv">isLoaded</span> <span class="o">=</span> <span class="nf">onInterstitiaLoaded</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">isLoaded</span> <span class="p">{</span>
          <span class="nf">onLoaded</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(()))</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nf">onLoaded</span><span class="p">(</span><span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="kt">NSError</span><span class="p">(</span><span class="s">"Custom interstitial failed loading"</span><span class="p">)))</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">showInterstitial</span><span class="p">(</span><span class="k">for</span> <span class="nv">adId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">onClosed</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">Void</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Here your code to display an interstitial ad</span>
      <span class="k">var</span> <span class="nv">interstitialController</span> <span class="o">=</span> <span class="nf">getCustomInsterstialController</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">adId</span><span class="p">,</span> <span class="nv">onClosed</span><span class="p">:</span> <span class="n">onClosed</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">loadRewarded</span><span class="p">(</span><span class="k">for</span> <span class="nv">adId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">onLoaded</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">Void</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Here your code to load and prepare an ad </span>
      <span class="k">let</span> <span class="nv">isLoaded</span> <span class="o">=</span> <span class="nf">onRewardedAdLoaded</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">isLoaded</span> <span class="p">{</span>
        <span class="nf">onLoaded</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(()))</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">onLoaded</span><span class="p">(</span><span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="kt">NSError</span><span class="p">(</span><span class="s">"Custom rewarded ad failed loading"</span><span class="p">)))</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">showRewarded</span><span class="p">(</span><span class="nv">forId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">onClosed</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">MiniAppReward</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">,</span> <span class="nv">onFailed</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Error</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Here your code to display your rewarded ad.</span>
      <span class="c1">// When the onClosed closure is called the user receives a reward you defined</span>
      <span class="k">var</span> <span class="nv">interstitialController</span> <span class="o">=</span> <span class="nf">getCustomRewrdedController</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">adId</span><span class="p">,</span> <span class="nv">onClosed</span><span class="p">:</span> <span class="n">onClosed</span><span class="p">,</span> <span class="nv">reward</span><span class="p">:</span> <span class="kt">MiniAppReward</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"star"</span><span class="p">,</span> <span class="nv">amount</span><span class="p">:</span> <span class="mi">100</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Once the delegate implemented, don&rsquo;t forget to provide it when you call a Mini App creation with the parameter <code>adsDelegate</code>:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">MiniAppParameters</span><span class="o">.</span><span class="nf">default</span><span class="p">(</span>
    <span class="nv">config</span><span class="p">:</span> <span class="kt">MiniAppConfig</span><span class="p">(</span><span class="nv">config</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">current</span><span class="p">(),</span> <span class="nv">adsDisplayer</span><span class="p">:</span> <span class="n">adsDisplayer</span><span class="p">,</span> <span class="nv">messageInterface</span><span class="p">:</span> <span class="k">self</span><span class="p">),</span>
    <span class="c1">//...</span>
<span class="p">)</span>
</code></pre>

<p><a id="retrieve-user-profile-details"></a></p>
<h4 id='retrieve-user-profile-details' class='heading'>Retrieve User Profile details</h4>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Protocols/MiniAppUserInfoDelegate.html">MiniAppUserInfoDelegate</a></p>

<p>Get the User profile related details using &#39;MiniAppMessageDelegate&rsquo;.
The following delegates/interfaces will be called only if the user has allowed respective <a href="#custom-permissions">Custom permissions</a></p>

<p><a id="user-profile-details-username"></a></p>
<h6 id='user-name' class='heading'>User Name</h6>

<p>Retrieve user name of the User</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getUserName</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Implementation to return the User name</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="s">""</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="user-profile-details-profilephoto"></a></p>
<h6 id='profile-photo' class='heading'>Profile Photo</h6>

<p>Retrieve Profile Photo of the User</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getProfilePhoto</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">?,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Implementation to return the Profile photo URI</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="s">""</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="user-profile-details-contactlist"></a></p>
<h6 id='contact-list' class='heading'>Contact List</h6>

<p>Retrieve the Contact list of the User</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getContacts</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">MAContact</span><span class="p">]?,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Implementation to return the contact list</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">([]))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="access-token-info"></a></p>
<h6 id='access-token-info' class='heading'>Access Token Info</h6>

<p>Retrieve access token and expiry date</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getAccessToken</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
                        <span class="nv">scopes</span><span class="p">:</span> <span class="kt">MASDKAccessTokenPermission</span><span class="p">?,</span>
                        <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">MATokenInfo</span><span class="p">,</span> <span class="kt">MASDKCustomPermissionError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>

        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">accessToken</span><span class="p">:</span> <span class="s">"ACCESS_TOKEN"</span><span class="p">,</span> <span class="nv">expirationDate</span><span class="p">:</span> <span class="kt">Date</span><span class="p">())))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="send-message-to-contacts"></a></p>
<h4 id='send-message-to-contacts' class='heading'>Send message to contacts</h4>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Protocols/ChatMessageBridgeDelegate.html">ChatMessageBridgeDelegate</a></p>

<p>Send a message to a contact from the <a href="#user-profile-details-contactlist">user profile contacts list</a> using &lsquo;MiniAppMessageDelegate&rsquo; methods.
Three methods can be triggered by the Mini App, and here are the recommended behaviors for each one:</p>

<table><thead>
<tr>
<th></th>
<th><code>sendMessageToContact(_:completionHandler:)</code></th>
<th><code>sendMessageToContactId(_:message:completionHandler:)</code></th>
<th><code>sendMessageToMultipleContacts(_:completionHandler:)</code></th>
</tr>
</thead><tbody>
<tr>
<td><strong>Triggered when</strong></td>
<td>Mini App wants to send a message to a contact.</td>
<td>Triggered when Mini App wants to send a message to a specific contact.</td>
<td>Triggered when Mini App wants to send a message to multiple contacts.</td>
</tr>
<tr>
<td><strong>Contact chooser needed</strong></td>
<td>single contact</td>
<td>None</td>
<td>multiple contacts</td>
</tr>
<tr>
<td><strong>Action</strong></td>
<td>send the message to the chosen contact</td>
<td>send a message to the specified contactId without any prompt to the User</td>
<td>send the message to all chosen contacts</td>
</tr>
<tr>
<td><strong>On success</strong></td>
<td>invoke completionHandler success with the ID of the contact which was sent the message.</td>
<td>invoke completionHandler success with the ID of the contact which was sent the message.</td>
<td>invoke completionHandler success with a list of IDs of the contacts which were successfully sent the message.</td>
</tr>
<tr>
<td><strong>On cancellation</strong></td>
<td>invoke completionHandler success with nil value.</td>
<td>invoke completionHandler success with nil value.</td>
<td>invoke completionHandler success with nil value.</td>
</tr>
<tr>
<td><strong>On error</strong></td>
<td>invoke completionHandler error when there was an error.</td>
<td>invoke completionHandler error when there was an error.</td>
<td>invoke completionHandler error when there was an error.</td>
</tr>
</tbody></table>

<p>Here is an example of integration:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
  <span class="kd">public</span> <span class="kd">func</span> <span class="nf">sendMessageToContact</span><span class="p">(</span><span class="n">_</span> <span class="nv">message</span><span class="p">:</span> <span class="kt">MessageToContact</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">?,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">presentContactsPicker</span> <span class="p">{</span> <span class="n">controller</span> <span class="k">in</span>
      <span class="n">controller</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
      <span class="n">controller</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="kt">NSLocalizedString</span><span class="p">(</span><span class="s">"Pick a contact"</span><span class="p">,</span> <span class="nv">comment</span><span class="p">:</span> <span class="s">""</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="kd">func</span> <span class="nf">sendMessageToContactId</span><span class="p">(</span><span class="n">_</span> <span class="nv">contactId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">message</span><span class="p">:</span> <span class="kt">MessageToContact</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">?,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">getContacts</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
      <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
      <span class="k">case</span> <span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">contacts</span><span class="p">):</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">contact</span> <span class="o">=</span> <span class="n">contacts</span><span class="o">.</span><span class="nf">first</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">contactId</span> <span class="p">})</span> <span class="p">{</span>
          <span class="c1">// insert here code to send the message</span>
          <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">contact</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="k">fallthrough</span>
        <span class="p">}</span>
      <span class="k">default</span><span class="p">:</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="o">.</span><span class="n">invalidContactId</span><span class="p">))</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="kd">func</span> <span class="nf">sendMessageToMultipleContacts</span><span class="p">(</span><span class="n">_</span> <span class="nv">message</span><span class="p">:</span> <span class="kt">MessageToContact</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">String</span><span class="p">]?,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">presentContactsPicker</span> <span class="p">{</span> <span class="n">chatContactsSelectorViewController</span> <span class="k">in</span>
      <span class="n">chatContactsSelectorViewController</span><span class="o">.</span><span class="n">contactsHandlerJob</span> <span class="o">=</span> <span class="n">completionHandler</span>
      <span class="n">chatContactsSelectorViewController</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
      <span class="n">chatContactsSelectorViewController</span><span class="o">.</span><span class="n">multipleSelection</span> <span class="o">=</span> <span class="kc">true</span>
      <span class="n">chatContactsSelectorViewController</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="kt">NSLocalizedString</span><span class="p">(</span><span class="s">"Select contacts"</span><span class="p">,</span> <span class="nv">comment</span><span class="p">:</span> <span class="s">""</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">presentContactsPicker</span><span class="p">(</span><span class="nv">controllerPresented</span><span class="p">:</span> <span class="p">(()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">contactsPickerCreated</span><span class="p">:</span> <span class="p">(</span><span class="kt">ChatContactsSelectorViewController</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">UIStoryboard</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"Main"</span><span class="p">,</span> <span class="nv">bundle</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">instantiateViewController</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"ChatContactsSelectorViewController"</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">ChatContactsSelectorViewController</span> <span class="p">{</span>
      <span class="kt">UINavigationController</span><span class="o">.</span><span class="nf">topViewController</span><span class="p">()?</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span><span class="kt">UINavigationController</span><span class="p">(</span><span class="nv">rootViewController</span><span class="p">:</span> <span class="n">viewController</span><span class="p">),</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="n">controllerPresented</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="retrieve-points"></a></p>
<h6 id='retrieve-points' class='heading'>Retrieve Points</h6>

<p>Retrieve Rakuten points (standard, term, cash) of the User. It&rsquo;s necessary to allow the <code>Rakuten Points</code> custom permission for retrieving the points.</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getPoints</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">MAPoints</span><span class="p">,</span> <span class="kt">MASDKPointError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Implementation to return points</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="kt">MAPoints</span><span class="p">(</span><span class="nv">standard</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="nv">term</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span> <span class="nv">cash</span><span class="p">:</span> <span class="mi">300</span><span class="p">)))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="file-download"></a></p>
<h6 id='file-download' class='heading'>File Download</h6>

<p>Support to download files of base64 urls.<br>
It&rsquo;s necessary to allow the <code>File Download</code> custom permission to make file downloads available.</p>

<p><a id="secure-storage"></a></p>
<h6 id='secure-storage' class='heading'>Secure Storage</h6>

<p>Allows MiniApps to store data safely in a key/value store.</p>

<p>Secure Storage will be initalized when <code>MiniAppSecureStorage.set</code> is called the first time. After initialization the storage will be automatically lazy loaded when the MiniApp is opened.</p>

<p>You can specify the max storage file size in <code><a href="Classes/MiniAppSdkConfig.html#/s:7MiniApp0aB9SdkConfigC21storageMaxSizeInBytess6UInt64VSgvp">MiniAppSdkConfig.storageMaxSizeInBytes</a></code> when creating a MiniApp.
When no maximum storage size is set the default value will be 2_000_000 (2Mb). Exceeding the file size limit will
throw an error <code>MiniAppSecureStorageError.storageFullError</code> when setting new values into the storage.</p>
<pre class="highlight swift"><code><span class="kt">MiniAppSdkConfig</span><span class="p">(</span>
    <span class="c1">//...</span>
    <span class="c1">// set the max size to 5 Mb</span>
    <span class="nv">storageMaxSizeInBytes</span><span class="p">:</span> <span class="mi">5_000_000</span>
<span class="p">)</span>
</code></pre>

<p>Use <code>wipeSecureStorages</code> to delete all secure storages stored on the device.</p>
<pre class="highlight swift"><code><span class="kt">MiniAppSecureStorage</span><span class="o">.</span><span class="nf">wipeSecureStorages</span><span class="p">()</span>
</code></pre>

<p><a id="send-message-to-hostapp"></a></p>
<h6 id='receive-string-information-from-miniapp' class='heading'>Receive string information from MiniApp</h6>

<p>You can receive the message string/json from MiniApp in to host app trough the universal bridge interface implemented in <code><a href="Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></code>.
To receive the message from the MiniApp and process it in the host app you must implement the delegeate method <code>sendJsonToHostApp(info:completionHandler:)</code> from the MiniAppMessageDelegate. </p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">sendJsonToHostApp</span><span class="p">(</span><span class="nv">info</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">MASDKProtocolResponse</span><span class="p">,</span> <span class="kt">UniversalBridgeError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Message form MiniApp: </span><span class="se">\(</span><span class="n">info</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="o">.</span><span class="n">success</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="load-miniapp-list"></a></p>
<h3 id='load-the-code-miniapp-code-list' class='heading'>Load the <code><a href="Classes/MiniApp.html">MiniApp</a></code> list:</h3>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Classes/MiniApp.html">MiniApp.list</a></p>

<p>MiniApp library calls are done via the <code>MiniApp.shared()</code> singleton with or without a <code><a href="Classes/MiniAppSdkConfig.html">MiniAppSdkConfig</a></code> instance (you can get the current one with <code>Config.current()</code>). If you don&rsquo;t provide a config instance, values in custom iOS target properties will be used by default. </p>
<pre class="highlight swift"><code><span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="n">list</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<p>or</p>
<pre class="highlight swift"><code><span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">current</span><span class="p">())</span><span class="o">.</span><span class="n">list</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<p><a id="get-mini-appinfo"></a></p>
<h3 id='getting-a-code-miniappinfo-code' class='heading'>Getting a <code><a href="Structs/MiniAppInfo.html">MiniAppInfo</a></code> :</h3>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Classes/MiniApp.html">MiniApp.info</a></p>
<pre class="highlight swift"><code><span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">info</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:</span> <span class="n">miniAppID</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<p>or</p>
<pre class="highlight swift"><code><span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">current</span><span class="p">())</span><span class="o">.</span><span class="nf">info</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:</span> <span class="n">miniAppID</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<p><a id="mini-meta-data"></a></p>
<h3 id='mini-app-meta-data' class='heading'>Mini App meta-data</h3>

<p><a id="get-mini-meta-data"></a></p>
<h4 id='getting-a-code-miniapp-meta-data-code' class='heading'>Getting a <code>MiniApp meta-data</code> :</h4>

<hr>

<p>MiniApp developers can define several metadata into the <code>manifest.json</code>:</p>

<ul>
<li><code>required</code> &amp; <code>optional</code> permissions</li>
<li>access token audience/scope permissions</li>
<li>custom variables/items inside <code>customMetaData</code>.</li>
</ul>

<p>Host app will use the defined interfaces to retrieve these details from manifest.json</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="s2">"reqPermissions"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"rakuten.miniapp.user.USER_NAME"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"reason"</span><span class="p">:</span><span class="s2">"Describe your reason here."</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"rakuten.miniapp.user.PROFILE_PHOTO"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"reason"</span><span class="p">:</span><span class="s2">"Describe your reason here."</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"optPermissions"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"rakuten.miniapp.user.CONTACT_LIST"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"reason"</span><span class="p">:</span><span class="s2">"Describe your reason here."</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"rakuten.miniapp.device.LOCATION"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"reason"</span><span class="p">:</span><span class="s2">"Describe your reason here."</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"accessTokenPermissions"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
          </span><span class="s2">"audience"</span><span class="p">:</span><span class="s2">"rae"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"scopes"</span><span class="p">:[</span><span class="s2">"idinfo_read_openid"</span><span class="p">,</span><span class="w"> </span><span class="s2">"memberinfo_read_point"</span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
          </span><span class="s2">"audience"</span><span class="p">:</span><span class="s2">"api-c"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"scopes"</span><span class="p">:[</span><span class="s2">"your_service_scope_here"</span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="s2">"customMetaData"</span><span class="p">:{</span><span class="w">
      </span><span class="s2">"hostAppRandomTestKey"</span><span class="p">:</span><span class="s2">"metadata value"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>You can retrieve the meta-data of a MiniApp using the following method,</p>
<pre class="highlight swift"><code><span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">getMiniAppManifest</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:</span> <span class="n">miniAppId</span><span class="p">,</span> 
                                    <span class="nv">miniAppVersion</span><span class="p">:</span> <span class="n">miniAppVersionId</span><span class="p">,</span> 
                                    <span class="nv">languageCode</span><span class="p">:</span> <span class="kt">NSLocale</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">languageCode</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">manifestData</span><span class="p">):</span>
            <span class="c1">// Retrieve the custom key/value pair like the following.</span>
            <span class="k">let</span> <span class="nv">randomTestKeyValue</span> <span class="o">=</span> <span class="n">manifestData</span><span class="o">.</span><span class="n">customMetaData</span><span class="p">?[</span><span class="s">"hostAppRandomTestKey"</span><span class="p">]</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">failure</span><span class="p">:</span>
          <span class="k">break</span>
    <span class="p">}</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<p>By passing the <code>languageCode</code> in the above <code>getMiniAppManifest</code> method, you can get the localized description/reason for the permission from the platform API. 
If there is no localized description/reason is available, it will return the default value given in the <code>manifest.json</code></p>

<p><a id="how-to-use-meta-data"></a></p>
<h4 id='how-to-use-code-miniapp-meta-data-code' class='heading'>How to use <code>MiniApp meta-data</code> :</h4>

<hr>

<p>SDK internally checks if the User has responded to the list of required/optional permissions that are enforced by the Mini App. So host app SHOULD make sure that the user is prompted with necessary custom permissions and get the response back from the user.</p>

<p>Before calling the <code>MiniApp.create</code>, host app should make sure the following things are done:</p>

<ul>
<li>Retrieve the meta-data for the Mini App using <a href="#get-mini-meta-data">getMiniAppManifest</a></li>
<li>Display/Prompt the list of required &amp; optional permissions to the user and the user response should be stored using <a href="#store-custom-permission">MiniApp.setCustomPermissions</a></li>
<li>Call <a href="#create-mini-app">MiniApp.create</a> to start downloading the Mini App</li>
</ul>

<p><a id="how-to-get-downloaded-meta-data"></a>
How to get downloaded <code>Mini App meta-data</code></p>

<hr>

<p>In Host App, we can get the downloaded manifest information as following:</p>
<pre class="highlight swift"><code>  <span class="k">let</span> <span class="nv">downloadedManifest</span> <span class="o">=</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">getDownloadedManifest</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:)</span>
</code></pre>

<p>HostApp can compare the old <code>downloadedManifest</code> and the latest manifest by calling <a href="#get-mini-meta-data">MiniApp.shared().getMiniAppManifest</a> to detect any new changes.</p>

<p><a id="list-downloaded-mini-apps"></a></p>
<h3 id='list-downloaded-mini-apps' class='heading'>List Downloaded Mini apps</h3>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Classes/MiniApp.html">MiniApp.listDownloadedWithCustomPermissions</a></p>

<p>Gets the list of downloaded Mini apps info and associated custom permissions status</p>
<pre class="highlight swift"><code> <span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">listDownloadedWithCustomPermissions</span><span class="p">()</span>
</code></pre>

<p><a id="advanced-features"></a></p>
<h3 id='advanced-features' class='heading'>Advanced Features</h3>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Classes/MiniAppSdkConfig.html">MiniAppSdkConfig</a></p>

<p>Along with Mini app features, Mini app SDK does provides more customization for the user. Some of the more customizable features are below,</p>

<p><a id="runtime-conf"></a></p>
<h4 id='overriding-configuration-on-runtime' class='heading'>Overriding configuration on runtime</h4>

<p>Every call to the API can be done with default parameters retrieved from the project .plist configuration file, or by providing a <code><a href="Classes/MiniAppSdkConfig.html">MiniAppSdkConfig</a></code> object during the call. Here is a simple example class we use to create the configuration in samples below:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">Config</span><span class="p">:</span> <span class="kt">NSObject</span> <span class="p">{</span>
    <span class="kd">class</span> <span class="kd">func</span> <span class="nf">current</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">MiniAppSdkConfig</span> <span class="p">{</span>
        <span class="kt">MiniAppSdkConfig</span><span class="p">(</span>
            <span class="nv">baseUrl</span><span class="p">:</span> <span class="s">"https://your.custom.url"</span><span class="p">,</span>
            <span class="nv">rasProjectId</span><span class="p">:</span> <span class="s">"your_RAS_Project_id"</span><span class="p">,</span>
            <span class="nv">subscriptionKey</span><span class="p">:</span> <span class="s">"your_subscription_key"</span><span class="p">,</span>
            <span class="nv">hostAppVersion</span><span class="p">:</span> <span class="s">"your_custom_version"</span><span class="p">,</span>
            <span class="nv">isPreviewMode</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nv">analyticsConfigList</span><span class="p">:</span> <span class="p">[</span><span class="kt">MAAnalyticsConfig</span><span class="p">(</span><span class="nv">acc</span><span class="p">:</span> <span class="s">"477"</span><span class="p">,</span> <span class="nv">aid</span><span class="p">:</span> <span class="s">"998"</span><span class="p">)],</span>
            <span class="nv">requireMiniAppSignatureVerification</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nv">sslKeyHash</span><span class="p">:</span> <span class="kt">MiniAppConfigSSLKeyHash</span><span class="p">(</span>
                <span class="nv">pin</span><span class="p">:</span> <span class="s">"AABBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB="</span><span class="p">,</span>
                <span class="nv">backup</span><span class="p">:</span> <span class="s">"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB="</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><em>NOTE:</em> <code>RMAHostAppUserAgentInfo</code> cannot be configured at run time.</p>

<p><a id="localization"></a></p>
<h4 id='overriding-localizations' class='heading'>Overriding localizations</h4>

<p>Mini App SDK localization is based on <a href="https://help.apple.com/xcode/mac/current/#/dev3255e0273">iOS framework localizable strings system</a>.
In the following table, you can find all the keys that the SDK is using to translate its texts to your UI language.
Mini App SDK will look in the host app <code>Localizable.strings</code> for these keys to find local texts. If these keys are not present, a default text is provided.</p>

<table><thead>
<tr>
<th>Localization key</th>
<th>Usage</th>
<th style="text-align: center">Default text</th>
<th>Parameters</th>
</tr>
</thead><tbody>
<tr>
<td><code>miniapp.sdk.ios.alert.title.ok</code></td>
<td>alert dialogs validation button</td>
<td style="text-align: center">OK</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.alert.title.cancel</code></td>
<td>alert dialogs cancellation button</td>
<td style="text-align: center">Cancel</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.ui.allow</code></td>
<td>permission screen authorization validation</td>
<td style="text-align: center">Allow</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.all.ui.save</code></td>
<td>permission screen denial validation</td>
<td style="text-align: center">Save</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.firstlaunch.footer</code></td>
<td>used at the bottom of the permissions validation screen</td>
<td style="text-align: center">%@<sup>[1]</sup> wants to access the above permissions. Choose your preference accordingly.\n\n  You can also manage these permissions later in the Miniapp settings</td>
<td><sup>[1]</sup> Mini App name</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.server</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Server returned an error. %@<sup>[1]</sup>: %@<sup>[2]</sup></td>
<td><sup>[1]</sup> Error code<br/><sup>[2]</sup> Error message</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.invalid_url</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">URL is invalid.</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.invalid_app_id</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Provided Mini App ID is invalid.</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.invalid_version_id</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Provided Mini App Version ID is invalid.</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.invalid_contact_id</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Provided contact ID is invalid.</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.invalid_response</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Invalid response received from server.</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.download_failed</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Failed to download the mini app.</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.miniapp_meta_data_required_permisions_failure</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Mini App has not been granted all of the required permissions.</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.unknown</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Unknown error occurred in %@<sup>[1]</sup> domain with error code %@<sup>[2]</sup>: %@<sup>[3]</sup></td>
<td><sup>[1]</sup> Error domain<br/><sup>[2]</sup> Error code<br/><sup>[3]</sup> Error message</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.host_app</code></td>
<td>error reporting (domain)</td>
<td style="text-align: center">Host app Error</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.failed_to_conform_to_protocol</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Host app failed to implement required interface</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.no_published_version</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Server returned no published versions for the provided Mini App ID.</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.miniapp_id_not_found</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Server could not find the provided Mini App ID.</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.unknown_server_error</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Unknown server error occurred</td>
<td>-</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.ad_not_loaded</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Ad %@<sup>[1]</sup> is not loaded yet</td>
<td><sup>[1]</sup>Ad id</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.ad_loading</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Previous %@<sup>[1]</sup> is still in progress</td>
<td><sup>[1]</sup>Ad id</td>
</tr>
<tr>
<td><code>miniapp.sdk.ios.error.message.ad_loaded</code></td>
<td>error reporting (decription)</td>
<td style="text-align: center">Ad %@<sup>[1]</sup> is already loaded</td>
<td><sup>[1]</sup>Ad id</td>
</tr>
</tbody></table>

<p>If you need to use one of this strings in your host application, you can use the convenience method <code>MASDKLocale.localize(_:_:)</code></p>

<p><a id="custom-navigation"></a></p>
<h4 id='add-a-web-navigation-interface-to-the-miniapp-view' class='heading'>Add a web navigation interface to the MiniApp view</h4>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Classes/MiniAppNavigationConfig.html">MiniAppNavigationConfig</a></p>

<p>MiniApp iOS SDK provides a fully customizable way to implement a navigation interface inside your html pages with a <code><a href="Classes/MiniAppNavigationConfig.html">MiniAppNavigationConfig</a></code> object. The class takes 3 arguments:</p>

<ul>
<li><code>navigationBarVisibility</code> : 

<ul>
<li>never = the UI will never be shown</li>
<li>auto = navigation UI is only shown when a back or forward action is available</li>
<li>always = navigation UI is always present</li>
</ul></li>
<li><code>navigationDelegate</code> : A delegate that will receive MiniApp view instructions about available navigation options. It will also receive taps on external links.</li>
<li><code>customNavigationView</code> : A view implementing <code><a href="Protocols/MiniAppNavigationDelegate.html">MiniAppNavigationDelegate</a></code> that will be overlayed to the bottom of the MiniApp view</li>
</ul>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">navConfig</span> <span class="o">=</span> <span class="kt">MiniAppNavigationConfig</span><span class="p">(</span>
                    <span class="nv">navigationBarVisibility</span><span class="p">:</span> <span class="o">.</span><span class="n">always</span><span class="p">,</span>
                    <span class="nv">navigationDelegate</span><span class="p">:</span> <span class="n">myNavigationDelegate</span><span class="p">,</span>
                    <span class="nv">customNavigationView</span><span class="p">:</span> <span class="n">mCustomView</span><span class="p">)</span>

<span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">current</span><span class="p">(),</span> <span class="nv">navigationSettings</span><span class="p">:</span> <span class="n">navConfig</span><span class="p">)</span><span class="o">.</span><span class="nf">info</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:</span> <span class="n">miniAppID</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
<span class="o">...</span>
<span class="p">}</span>
</code></pre>
<h4 id='opening-external-links' class='heading'>Opening external links</h4>

<hr>

<p><strong>API Docs:</strong> <a href="https://rakutentech.github.io/ios-miniapp/Classes/MiniAppExternalUrlLoader.html">MiniAppNavigationConfig</a></p>

<p>By default MiniApp iOS SDK will open external links into a separate modal controller when tapped. <code><a href="Protocols/MiniAppNavigationDelegate.html">MiniAppNavigationDelegate</a></code> implements a method that allows to override this behaviour and provide your own external links management. Here is an example of implementation:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppNavigationDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">miniAppNavigation</span><span class="p">(</span><span class="n">shouldOpen</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">,</span> <span class="n">with</span> <span class="nv">externalLinkResponseHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">URL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Getting your custom viewcontroller</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">UIStoryboard</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"Main"</span><span class="p">,</span> <span class="nv">bundle</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span><span class="o">.</span><span class="nf">instantiateViewController</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"ExternalWebviewController"</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">ExternalWebViewController</span> <span class="p">{</span>
            <span class="n">viewController</span><span class="o">.</span><span class="n">currentURL</span> <span class="o">=</span> <span class="n">url</span>
            <span class="n">viewController</span><span class="o">.</span><span class="n">miniAppExternalUrlLoader</span> <span class="o">=</span> <span class="kt">MiniAppExternalUrlLoader</span><span class="p">(</span><span class="nv">webViewController</span><span class="p">:</span> <span class="n">viewController</span><span class="p">,</span> <span class="nv">responseHandler</span><span class="p">:</span> <span class="n">externalLinkResponseHandler</span><span class="p">)</span>
            <span class="k">self</span><span class="o">.</span><span class="n">presentedViewController</span><span class="p">?</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<p>The <code>externalLinkResponseHandler</code> closure allows you to give a feedback as an URL to the SDK, for example when the controller is closed or when a custom scheme link is tapped. This closure can be passed to a <code><a href="Classes/MiniAppExternalUrlLoader.html">MiniAppExternalUrlLoader</a></code> object that will provide a method to test an URL and return the appropriate decision for a <code>WKNavigationDelegate</code> method, and if you provided a controller it will be dismissed automatically. Here is an example following previous example:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ExternalWebViewController</span><span class="p">:</span> <span class="kt">WKNavigationDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">webView</span><span class="p">(</span><span class="n">_</span> <span class="nv">webView</span><span class="p">:</span> <span class="kt">WKWebView</span><span class="p">,</span> <span class="n">didFinish</span> <span class="nv">navigation</span><span class="p">:</span> <span class="kt">WKNavigation</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">currentURL</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">webView</span><span class="o">.</span><span class="n">url</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">webView</span><span class="p">(</span><span class="n">_</span> <span class="nv">webView</span><span class="p">:</span> <span class="kt">WKWebView</span><span class="p">,</span> <span class="n">decidePolicyFor</span> <span class="nv">navigationAction</span><span class="p">:</span> <span class="kt">WKNavigationAction</span><span class="p">,</span> <span class="nv">decisionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">WKNavigationActionPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">decisionHandler</span><span class="p">(</span><span class="n">miniAppExternalUrlLoader</span><span class="p">?</span><span class="o">.</span><span class="nf">shouldOverrideURLLoading</span><span class="p">(</span><span class="n">navigationAction</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span> <span class="p">??</span> <span class="o">.</span><span class="n">allow</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="orientation-lock"></a></p>
<h4 id='orientation-lock' class='heading'>Orientation Lock</h4>

<p>You can choose to give orientation lock control to Mini Apps. However, this requires you to add some code to your <code>AppDelegate</code> which could have an affect on your entire App. If you do not wish to do this, please see the section <em>&ldquo;Allow only full screen videos to change orientation&rdquo;.</em></p>
<h5 id='allow-mini-apps-to-lock-the-view-to-any-orientation' class='heading'>Allow Mini Apps to lock the view to any orientation</h5>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">supportedInterfaceOrientationsFor</span> <span class="nv">window</span><span class="p">:</span> <span class="kt">UIWindow</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">UIInterfaceOrientationMask</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">window</span><span class="p">?</span><span class="o">.</span><span class="n">isKeyWindow</span> <span class="o">!=</span> <span class="kc">true</span> <span class="p">{</span>
            <span class="k">return</span> <span class="o">.</span><span class="n">all</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="kt">MAOrientationLock</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
            <span class="k">return</span> <span class="o">.</span><span class="n">all</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="kt">MAOrientationLock</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
<h5 id='allow-full-screen-videos-to-change-orientation' class='heading'>Allow full screen videos to change orientation</h5>

<p>You can add the following if you want to enable videos to change orientation. Note that if you do not wish to add code to <code>AppDelegate</code> as in the above example, you can still allow videos inside the Mini App to use landscape mode even when your App is locked to portrait mode and vice versa.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">AVKit</span>

<span class="kd">extension</span> <span class="kt">AVPlayerViewController</span> <span class="p">{</span>
    <span class="kd">open</span> <span class="k">override</span> <span class="k">var</span> <span class="nv">supportedInterfaceOrientations</span><span class="p">:</span> <span class="kt">UIInterfaceOrientationMask</span> <span class="p">{</span>
        <span class="k">if</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="kt">MAOrientationLock</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
            <span class="k">return</span> <span class="o">.</span><span class="n">all</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="kt">MAOrientationLock</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="analytics-events"></a></p>
<h4 id='analytics-events' class='heading'>Analytics events</h4>

<p>MiniApp iOS SDK sends some notification to your app when some events are triggered by a MiniApp:</p>

<ul>
<li>When it is launched</li>
<li>When it is closed</li>
</ul>

<p>To catch this events and retrieve insight data, you simply have to register to the notification center like this:</p>
<pre class="highlight swift"><code><span class="kt">NotificationCenter</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">selector</span><span class="p">:</span> <span class="kd">#selector(</span><span class="nf">yourMethod(_:)</span><span class="kd">)</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">MiniAppAnalytics</span><span class="o">.</span><span class="n">notificationName</span><span class="p">,</span> <span class="nv">object</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>
<pre class="highlight swift"><code><span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">yourMethod</span><span class="p">(</span><span class="n">_</span> <span class="nv">notification</span><span class="p">:</span><span class="kt">Notification</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="k">let</span> <span class="nv">payload</span> <span class="o">=</span> <span class="n">notification</span><span class="o">.</span><span class="n">object</span> <span class="k">as?</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span><span class="kt">String</span><span class="p">]</span> <span class="p">{</span>
    <span class="c1">// do something with the data   </span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Here is an example of data contained in payload:</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"etype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"click"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"actype"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mini_app_open"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"cp"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"mini_app_project_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"mini_app_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4321"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"mini_app_version_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><a id="query-param-mini-app"></a></p>
<h3 id='passing-query-parameters-while-creating-mini-app' class='heading'>Passing Query parameters while creating Mini App</h3>

<p>While creating a Mini App, you can pass the optional query parameter as well. This query parameter will be appended to the Mini App&rsquo;s URL.</p>

<p>For eg.,</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">MiniAppParameters</span><span class="o">.</span><span class="nf">default</span><span class="p">(</span>
    <span class="nv">config</span><span class="p">:</span> <span class="kt">MiniAppConfig</span><span class="p">(</span><span class="nv">config</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">current</span><span class="p">(),</span> <span class="nv">messageInterface</span><span class="p">:</span> <span class="k">self</span><span class="p">),</span>
    <span class="nv">appId</span><span class="p">:</span> <span class="s">"your-miniapp-id"</span><span class="p">,</span>
    <span class="nv">queryParams</span><span class="p">:</span> <span class="s">"param1=value1&amp;param2=value2"</span>
<span class="p">)</span>
<span class="k">let</span> <span class="nv">miniAppView</span> <span class="o">=</span> <span class="kt">MiniAppView</span><span class="p">(</span><span class="nv">params</span><span class="p">:</span> <span class="n">params</span><span class="p">)</span>
<span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">miniAppView</span><span class="p">)</span>
<span class="n">miniAppView</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span>
<span class="n">miniAppView</span><span class="o">.</span><span class="n">load</span> <span class="p">{</span> <span class="n">success</span> <span class="k">in</span> 
    <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre>

<p>And the Mini App will be loaded like the following scheme,</p>
<pre class="highlight plaintext"><code>mscheme.rakuten//miniapp/index.html?param1=value1&amp;param2=value2
</code></pre>

<p><a id="permissions-from-host-app"></a></p>
<h3 id='permissions-required-from-the-host-app' class='heading'>Permissions required from the Host app</h3>

<p>Mini App SDK requires the host app to include the following set of device permissions into its Info.plist file:</p>

<table><thead>
<tr>
<th>Plist key</th>
<th style="text-align: center">Permission</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><a href="https://developer.apple.com/documentation/bundleresources/information_property_list/nslocationalwaysandwheninuseusagedescription">NSLocationAlwaysAndWhenInUseUsageDescription</a></td>
<td style="text-align: center">Location</td>
<td>Mini app to track/get the current location of the user</td>
</tr>
<tr>
<td><a href="https://developer.apple.com/documentation/bundleresources/information_property_list/nscamerausagedescription">NSCameraUsageDescription</a></td>
<td style="text-align: center">Camera</td>
<td>Camera permission required by Mini app to take pictures</td>
</tr>
<tr>
<td><a href="https://developer.apple.com/documentation/bundleresources/information_property_list/nsmicrophoneusagedescription">NSMicrophoneUsageDescription</a></td>
<td style="text-align: center">Microphone</td>
<td>Microphone permission required by Mini app to record a video.</td>
</tr>
</tbody></table>

<p><a id="miniapp-events"></a></p>
<h3 id='miniapp-events' class='heading'>MiniApp events</h3>

<p>Mini App SDK allows MiniApps to react to several events triggered by host app. These include</p>

<table><thead>
<tr>
<th>Event</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code>pause</code></td>
<td>MiniApp view controller will disappear, MiniApp will open an external web view, host application will resign to be active</td>
</tr>
<tr>
<td><code>resume</code></td>
<td>MiniApp view controller did appear, user closed a web view launched by MiniApp, host application did become active</td>
</tr>
<tr>
<td><code>externalWebViewClosed</code></td>
<td>user closed a web view launched by MiniApp</td>
</tr>
</tbody></table>

<p><a id="miniapp-load-cache"></a></p>
<h3 id='load-mini-app-from-cache' class='heading'>Load Mini app from Cache</h3>

<p>Load Mini-app from cache directly using the following approach,</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">miniAppView</span> <span class="o">=</span> <span class="kt">MiniAppView</span><span class="p">(</span><span class="nv">params</span><span class="p">:</span> <span class="n">params</span><span class="p">)</span>
<span class="n">miniAppView</span><span class="o">.</span><span class="nf">load</span><span class="p">(</span><span class="nv">fromCache</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="n">success</span> <span class="k">in</span> 
    <span class="c1">// ...</span>
<span class="p">}</span>

</code></pre>

<p><code>fromCache</code> helps to retrieve the already downloaded mini-app from the cache.
NOTE: Using the above approach will never retrieve/query latest version of the mini-app.</p>

<p><a id="miniapp-send-json-from-hostapp"></a></p>
<h3 id='send-json-string-content-from-the-host-app-to-miniapp' class='heading'>Send JSON/String content from the host app to MiniApp.</h3>

<p>Send JSON or a string conent to mini app from the host app using the below sdk api,
This api will send the content message/json to the mini app using the custom events which will must be listned by the mini apps to receive the content.</p>
<pre class="highlight swift"><code><span class="n">miniAppView</span><span class="o">.</span><span class="nf">sendJsonToMiniApp</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"&lt;Your string content / json content&gt;"</span><span class="p">)</span>

</code></pre>

<p><code>string</code> This will hold the Json or stringcontent to be sent to MiniApp from the host app.
NOTE: Using the above approach will never retrieve/query latest version of the mini-app.</p>

<p><a id="keyboard-events"></a></p>
<h3 id='keyboard-events' class='heading'>Keyboard Events</h3>

<p>MiniApp SDK allows to send keyboard <code>shown</code> and <code>hidden</code> events.</p>
<pre class="highlight swift"><code><span class="kt">MiniApp</span>
    <span class="o">.</span><span class="nf">shared</span><span class="p">()</span>
    <span class="o">.</span><span class="nf">keyboardShown</span><span class="p">(</span><span class="nv">navigationBarHeight</span><span class="p">:</span> <span class="mi">84</span><span class="p">,</span> <span class="nv">screenHeight</span><span class="p">:</span> <span class="mi">814</span><span class="p">,</span> <span class="nv">keyboardheight</span><span class="p">:</span> <span class="mi">350</span><span class="p">)</span>

<span class="kt">MiniApp</span>
    <span class="o">.</span><span class="nf">shared</span><span class="p">()</span>
    <span class="o">.</span><span class="nf">keyboardHidden</span><span class="p">(</span><span class="nv">navigationBarHeight</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">screenHeight</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">keyboardheight</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>

</code></pre>

<p>These events can be listened to by the JS SDK </p>
<pre class="highlight javascript"><code><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">MiniAppKeyboardEvents</span><span class="p">.</span><span class="nx">KEYBOARDSHOWN</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">MiniAppKeyboardEvents</span><span class="p">.</span><span class="nx">KEYBOARDHIDDEN</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre>

<p><a id="miniapp-close"></a></p>
<h3 id='miniapp-close' class='heading'>MiniApp Close</h3>

<p>MiniApp can request the host app to close itself through the javascript bridge event trigger.
MiniAppSDK in iOS provides the <code><a href="Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></code> interface method <code>func closeMiniApp(withConfirmation: , completionHandler:)</code> which can be implemented in the host app. This delegate method is an optional.</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">closeMiniApp</span><span class="p">(</span><span class="nv">withConfirmation</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">Bool</span><span class="p">,</span> <span class="kt">MiniAppJavaScriptError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">withConfirmation</span> <span class="p">{</span>
            <span class="c1">// You can handle the close action with confirmation alert.</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// you can directly  close the MiniApp without the confirmation alert.</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="miniapp-getHostAppThemeColors"></a></p>
<h3 id='send-host-app-theme-colors-to-miniapp' class='heading'>Send Host App Theme Colors to MiniApp</h3>

<p>MiniApp can request the host app to share the Themes primary and secondary colors through the javascript bridge event trigger.
MiniAppSDK in iOS provides the <code><a href="Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></code> interface method <code>func getHostAppThemeColors(completionHandler: @escaping (Result&lt;HostAppThemeColors?, MASDKError&gt;) -&gt; Void)</code> which can be implemented in the host app. This delegate method is an optional.</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getHostAppThemeColors</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">HostAppThemeColors</span><span class="p">?,</span> <span class="kt">MASDKError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">completionHandler</span><span class="p">(</span>
            <span class="o">.</span><span class="nf">success</span><span class="p">(</span>
                <span class="kt">HostAppThemeColors</span><span class="p">(</span>
                    <span class="nv">primaryColor</span><span class="p">:</span> <span class="s">"#FF008C"</span><span class="p">,</span>
                    <span class="nv">secondaryColor</span><span class="p">:</span> <span class="s">"#7D64BE"</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="miniapp-sendAnalytics"></a></p>
<h3 id='receive-miniapp-analytics' class='heading'>Receive MiniApp Analytics</h3>

<p>MiniApps can send the analytics information to host app through the <code>sendAnalytics</code> interface defined in JS-SDK.
iOS Hostapp can extend this optional <code>MAAnalayticsDelegate</code> interface/delegate to receive the analytics that is sent from the Miniapp.</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MAAnalyticsDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">didReceiveMAAnalytics</span><span class="p">(</span><span class="nv">analyticsInfo</span><span class="p">:</span> <span class="kt">MAAnalyticsInfo</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">MASDKProtocolResponse</span><span class="p">,</span> <span class="kt">MAAnalyticsError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">analyticsInfo</span><span class="p">)</span>
            <span class="c1">// analyticsInfo: MAAnalyticsInfo - This object holds the Analytics info of the events triggered from MiniApps, This can be further used to record the MiniApp Analytics events from host app.</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="o">.</span><span class="n">success</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p><a id="miniapp-cache-available"></a></p>
<h3 id='miniapp-cache-available' class='heading'>MiniApp Cache available</h3>

<p>Host app can check if Miniapp is downloaded and cached already using the following interface</p>
<pre class="highlight swift"><code><span class="k">if</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="nf">isMiniAppCacheAvailable</span><span class="p">(</span><span class="nv">appId</span><span class="p">:</span> <span class="n">miniAppId</span><span class="p">,</span> <span class="nv">versionId</span><span class="p">:</span> <span class="n">versionId</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Returns true if Miniapp is available</span>
<span class="p">}</span>
</code></pre>

<p><a id="faqs-and-troubleshooting"></a></p>
<h2 id='faqs-and-troubleshooting' class='heading'>FAQs and Troubleshooting</h2>
<h3 id='how-do-i-deep-link-to-mini-apps' class='heading'>How do I deep link to mini apps?</h3>

<p>If you want to have deep links directly to your mini apps, then you must implement deep link handling within your App. This can be done using either a custom deep link scheme (such as <code>myAppName://miniapp</code>) or a <a href="https://developer.apple.com/ios/universal-links/">Universal Link</a> (such as <code>https://www.example.com/miniapp</code>). See the following resources for more information on how to implement deep linking capabilities:</p>

<ul>
<li><a href="https://developer.apple.com/documentation/xcode/allowing_apps_and_websites_to_link_to_your_content">Allowing Apps and Websites to Link to Your Content</a></li>
<li><a href="https://developer.apple.com/documentation/safariservices/supporting_associated_domains">Supporting Associated Domains</a></li>
</ul>

<p>After you have implemented deep linking capabilities in your App, then you can configure your deep link to open and launch a Mini App. Note that your deep link should contain information about which mini app ID to open. Also, you can pass query parameters and a URL fragment to the mini app. The recommended deep link format is similar to <code>https://www.example.com/miniapp/MINI_APP_ID?myParam=myValue#myFragment</code> where the <code>myParam=myValue#myFragment</code> portion is optional and will be passed directly to the mini app. </p>

<p>The following is an example which will parse the mini app ID and query string from a deep link:</p>
<pre class="highlight swift"><code><span class="c1">// In your AppDelegate</span>
<span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="k">continue</span> <span class="nv">userActivity</span><span class="p">:</span> <span class="kt">NSUserActivity</span><span class="p">,</span> <span class="nv">restorationHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">([</span><span class="kt">UIUserActivityRestoring</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="n">userActivity</span><span class="o">.</span><span class="n">activityType</span> <span class="o">==</span> <span class="kt">NSUserActivityTypeBrowsingWeb</span><span class="p">,</span>
        <span class="k">let</span> <span class="nv">incomingURL</span> <span class="o">=</span> <span class="n">userActivity</span><span class="o">.</span><span class="n">webpageURL</span><span class="p">,</span>
        <span class="k">let</span> <span class="nv">components</span> <span class="o">=</span> <span class="kt">URLComponents</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">incomingURL</span><span class="p">,</span> <span class="nv">resolvingAgainstBaseURL</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nf">handleDeepLink</span><span class="p">(</span><span class="nv">components</span><span class="p">:</span> <span class="n">components</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">handleDeepLink</span><span class="p">(</span><span class="nv">components</span><span class="p">:</span> <span class="kt">URLComponents</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
<span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">host</span> <span class="o">=</span> <span class="n">components</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">host</span> <span class="o">==</span> <span class="s">"example.com"</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">pathComponents</span> <span class="o">=</span> <span class="n">components</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="nf">split</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span>
    <span class="k">guard</span>
        <span class="k">let</span> <span class="nv">rootPath</span> <span class="o">=</span> <span class="n">pathComponents</span><span class="o">.</span><span class="n">first</span>
    <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">false</span> <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">rootPath</span> <span class="o">==</span> <span class="s">"miniapp"</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">guard</span>
            <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="n">pathComponents</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">false</span> <span class="p">}</span>

        <span class="k">let</span> <span class="nv">query</span> <span class="o">=</span> <span class="n">components</span><span class="o">.</span><span class="n">query</span> <span class="p">??</span> <span class="s">""</span>
        <span class="k">let</span> <span class="nv">fragment</span> <span class="o">=</span> <span class="n">components</span><span class="o">.</span><span class="n">fragment</span> <span class="p">??</span> <span class="s">""</span>
        <span class="k">let</span> <span class="nv">queryString</span> <span class="o">=</span> <span class="n">query</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">fragment</span>

        <span class="c1">// Note that `myMiniAppCoordinator` is just a placeholder example for your own class</span>
        <span class="c1">// Inside this class you should call `MiniApp.create` in order to create and display the mini app</span>
        <span class="n">myMiniAppCoordinator</span><span class="o">.</span><span class="nf">goToMiniApp</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:</span> <span class="n">id</span><span class="p">,</span> <span class="nv">query</span><span class="p">:</span> <span class="n">queryString</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kc">false</span>
<span class="p">}</span>
</code></pre>
<h3 id='how-do-i-clear-the-session-data-for-mini-apps' class='heading'>How do I clear the session data for Mini Apps?</h3>

<p>In the case that a user logs out of your App, you should clear the session data for all of your Mini Apps. This will ensure that the next user does not have access to the stored sensitive information about the previous user such as Local Storage, IndexedDB, and Web SQL.</p>

<p>The session data can be cleared by using the following:</p>
<pre class="highlight swift"><code><span class="kt">WKWebsiteDataStore</span><span class="o">.</span><span class="nf">default</span><span class="p">()</span><span class="o">.</span><span class="nf">removeData</span><span class="p">(</span><span class="nv">ofTypes</span><span class="p">:</span> <span class="kt">WKWebsiteDataStore</span><span class="o">.</span><span class="nf">allWebsiteDataTypes</span><span class="p">(),</span> 
    <span class="nv">modifiedSince</span><span class="p">:</span> <span class="kt">Date</span><span class="o">.</span><span class="n">distantPast</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1">// Data removal complete</span>
<span class="p">})</span>
</code></pre>

<p><strong>Note:</strong> This will also clear the storage, cookies, and authentication data for ALL <code>WkWebViews</code> used by your App.</p>

<p><a id="change-log"></a></p>
<h2 id='changelog' class='heading'>Changelog</h2>

<p>See the full <a href="https://github.com/rakutentech/ios-miniapp/blob/master/CHANGELOG.md">CHANGELOG</a>.</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2023 <a class="link" href="https://github.com/rakutentech/ios-miniapp" target="_blank" rel="external noopener">Rakuten Ecosystem Mobile</a>. All rights reserved. (Last updated: 2023-10-16)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external noopener">jazzy ♪♫ v0.14.4</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external noopener">Realm</a> project.</p>
    </section>
  </body>
</html>
